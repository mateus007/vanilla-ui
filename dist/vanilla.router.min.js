!function(e){var t={routes:[],beforeChangeHooks:[],afterChangeHooks:[]},r=!1,o={path:null,regex:null,location:null,query:{},params:{},getParam:function(e){return void 0===e?this.params:void 0!==this.params[e]?this.params[e]:void 0},getQuery:function(e){return void 0===e?this.query:void 0!==this.query[e]?this.query[e]:void 0},getLocation:function(){var e=this.params,t=this.path;for(const r in e)e.hasOwnProperty(r)&&(t=t.replace(":"+r,e[r]));return t}};e.extend(e,{_abstractRoute:o,router:{$mode:window.history.pushState?"history":"hash",$active:null,beforeChange:function(e){t.beforeChangeHooks.push(e)},afterChange:function(e){t.afterChangeHooks.push(e)},normalizePath:function(e){return e=(e=("/"+(e=(e=(e=e.replace(window.location.origin,"")).replace(new RegExp("[/]*$"),"")).replace(new RegExp("^[/]*"),""))).replace("//","/").replace("/?","?")).split("?")[0]},add:function(r){if(Array.isArray(r)){var o=this;r.forEach(function(e){o.add(e)})}else{var a=Object.assign({},e._abstractRoute,r);a.path=this.normalizePath(a.path);var n=a.path,i=["([^/]+)"];["(:[a-zA-Z]+)"].forEach(function(e,t){n=n.replace(new RegExp(e,"g"),i[t])}),n=new RegExp("^"+n+"$","i"),a.regex=n,t.routes.push(a)}},change:async function(o,a){try{var n={previous:e.router.$active,next:e.router.getMatch(o),location:o,replace:a};await e.promises(n,[].concat(t.beforeChangeHooks,[function(t){this.replace&&(r=!0,"history"===e.router.$mode?history.pushState({},null,this.location):window.location.hash=this.location,r=!1);var o=this.next;if(!o)return e.router.$active=null,t(this);var a=e.router.retrieveQueryFor(this.location),n=e.router.retrieveParamsFor(this.location,o);o.query=a,o.params=n,e.router.$active=o,t(this)}],t.afterChangeHooks))}catch(e){console.warn(e)}},retrieveParamsFor:function(e,t){var r={},o=this.normalizePath(t.path).split("/").filter(Boolean);return this.normalizePath(e).split("/").filter(Boolean).forEach(function(e,t){if(void 0!==o[t]&&":".charCodeAt(0)===o[t].charCodeAt(0)){const a=o[t].substr(1);r[a]=decodeURIComponent(e)}}),r},retrieveQueryFor:function(e){var t={};return""==(e=(e=(e=e.split("?"))[1]?e[1]:e[0]).trim().replace(/^(\?|#|&)/,""))?t:(e.split("&").forEach(function(e){const r=e.replace(/\+/g," ").split("="),o=decodeURIComponent(r.shift()),a=r.length>0?decodeURIComponent(r.join("=")):null;void 0===t[o]&&(t[o]=a)}),t)},getMatch:function(e){var r=this.normalizePath(e),o=t.routes,a=null;for(let e=0;e<o.length;e++){const t=o[e];if(r.match(t.regex)){a=t;break}}return a},redirect:function(e){this.change(e,!0)},goBack:function(e){null==e&&(e=-1),window.history.go(e)}}}),e.on(window,"popstate",function(){if(!r){var t="hash"===e.router.$mode?window.location.hash.replace("#",""):window.location.pathname;t=e.router.normalizePath(t),e.router.change(t)}}),e.on(document,"click","a",function(t){var r=t.currentTarget,o=window.location,a=function(e){return e.href.replace(/#.*/,"")};t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||r.protocol&&o.protocol!==r.protocol||r.hostname&&o.hostname!==r.hostname||"hash"!==e.router.$mode&&r.href.indexOf("#")>-1&&a(r)==a(o)||r.target&&""!==r.target||t.defaultPrevented||(e.router.redirect(this.href),t.preventDefault())})}(window.V);