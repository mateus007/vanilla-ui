var V=function(e){"use strict";var t=[];function n(e,n){if(void 0===n)return t[e]?t[e]:[];t[e]=t[e]||[],t[e].push(n)}function r(e){return e=(e="string"==typeof e?o(e):e)instanceof Node?e:document}function o(e,t){return r(t).querySelector(e)}function a(e,t){return r(t).querySelectorAll(e)}function c(e,t){var n=[];return"string"==typeof e&&(e=a(e,t)),e instanceof Window&&n.push(e),e instanceof HTMLDocument&&n.push(e),e instanceof Element&&n.push(e),e instanceof NodeList&&Array.prototype.forEach.call(e,function(e){n.push(e)}),n}function i(e,t,n,r,o){var a,i=c(t),s=n.split(" ");return void 0===o?(a=r,r=null):a=function(e){var t=e.target.closest(r);t&&o.apply(t,[e])},i.forEach(function(t){for(var n=0;n<s.length;n++)"add"==e?t.addEventListener(s[n],a.bind(t),!1):t.removeEventListener(s[n],a.bind(t),!1)}),a}function s(e,t,n,r){return i("add",e,t,n,r)}function u(e,t,n,r){return i("remove",e,t,n,r)}async function f(){}async function p(e,t){try{return await t.apply(e)}catch(e){return Promise.reject(e)}}async function l(e,t){var n=[];for(let r=0;r<t.length;r++)"function"==typeof t[r]&&n.push(p(e,t[r]));return await Promise.all(n),e}function h(e,t){var n,r=/{{([^}}]+)?}}/g,o=[],a=0,c="",i="",s="";for(o.push("var r=[];");n=r.exec(e);)c=n[0].replace(/\s+/," ").replace(/^{{\s?/,"").replace(/\s?}}$/,"").replace(/^else$/,"} else {").replace(/^end$/,"}").replace(/^if\s?(.*)$/,"if( this.$1 ){").replace(/^for\s?(.*)\sin\s(.*)$/,"for( var $1 in this.$2 ){").replace(/^each\s?(.*)\sin\s(.*)$/,"for( var _$1 in this.$2 ){ this.$1 = this.$2[_$1];").replace(/^(?!}|{|for\(|if\()(.*)/,"this.$1"),i=e.slice(a,n.index),a=n.index+n[0].length,o.push('r.push("'+i.replace(/"/g,'\\"')+'");'),o.push(c.match(/^(}|{|for\(|if\()/)?c:"r.push("+c+");");s=e.substr(a,e.length-a),o.push('r.push("'+s.replace(/"/g,'\\"')+'");'),o.push('return r.join("");');var u=o.join("").replace(/[\r\t\n]/g,"");return new Function(u).apply(t||{})}var d=[],v={element:null,selector:null,namespace:null,constructor:f,destructor:f};function m(e){Object.assign(v,e)}function y(e,t){d.forEach(function(n){c(n.selector,e).forEach(function(e){void 0===e._components&&(e._components={}),void 0===e._state&&(e._state={}),void 0===e._events&&(e._events={}),t.apply(e,[e,n])})})}function g(e){n("componentAfterMount",e)}async function _(e){var t=[];return y(e,function(e,r){var o=r.namespace;if(void 0===e._components[o]){e.dataset.vid||(e.dataset.vid=Math.random().toString(16).substr(2,8));var a=Object.assign({},r);a.element=e,e._components[o]=a;var c=[].concat(n("componentBeforeMount"),[a.beforeMount],[a.onMount],[a.afterMount],n("componentAfterMount"));t.push(l(a,c))}}),await Promise.all(t),e}async function w(e,t,r,o){var a={method:e,url:t,data:r,headers:o,options:{},response:null};if(await l(a,n("httpInterceptBefore")),a.headers&&(a.options.headers=a.headers),a.method&&(a.options.method=a.method),"GET"!=a.options.method)a.data instanceof FormData==0&&(a.data=JSON.stringify(a.data)),a.options.body=a.data;else{var c="";"string"==typeof a.data?c=a.data:a.data&&(c=Object.keys(a.data).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(a.data[e])}).join("&")),c&&(a.url+="?"+c)}return fetch(a.url,a.options).then(async function(e){return a.response=e,await l(a,n("httpInterceptAfter")),a.response}).then(async function(e){if(!e.ok)throw e;const t=await e.text();try{return JSON.parse(t)}catch(e){return t}})}m({beforeDestroy:f,onDestroy:f,afterDestroy:f}),m({on:function(e,t,n){var r=this.element;void 0===n?(n=t,t=this.selector):t=this.selector+" "+t;var o=e+"-"+t,a=r.dataset.vid;a='[data-vid="'+a+'"]';r._events[o]=s(document,e,t,function(e){e.target.closest(a)&&n.apply(e.target.closest(t),[e])})},off:function(e,t){var n=this.element,r=e+"-"+(t=t?this.selector+" "+t:this.selector),o=n._events[r];o&&(delete n._events[r],u(document,e,t,o))}}),m({beforeMount:f,onMount:f,afterMount:f}),m({template:f,renderTemplate:async function(){var e=await this.template();if(void 0!==e&&!1!==e){var t=h(String(e),this.get());this.element.innerHTML=t}},shouldRender:async function(){return!0},beforeRender:f,onRender:f,afterRender:f,render:async function(){if(await this.shouldRender())try{var e=[].concat(n("componentBeforeRender"),[this.beforeRender],[this.renderTemplate],[this.onRender],[this.afterRender],n("componentAfterRender"));await l(this,e),await _(this.element)}catch(e){console.warn("[V] Component render error:",e)}}}),g(async function(){return this.render()}),m({set:function(e,t){if("string"!=typeof e)n._state=Object.assign(n._state,e);else{var n=this.element;n._state[e]=t}},get:function(e,t){var n=this.element;if(void 0===e)return n._state;var r=n._state[e];return r=void 0===r?t:r},update:async function(){return this.render()}});var b=Object.freeze({__proto__:null,interceptBefore:function(e){n("httpInterceptBefore",e)},interceptAfter:function(e){n("httpInterceptAfter",e)},request:w,options:function(e,t,n){return w("OPTIONS",e,t,n)},head:function(e,t,n){return w("HEAD",e,t,n)},get:function(e,t,n){return w("GET",e,t,n)},post:function(e,t,n){return w("POST",e,t,n)},put:function(e,t,n){return w("PUT",e,t,n)},patch:function(e,t,n){return w("PATCH",e,t,n)},_delete:function(e,t,n){return w("DELETE",e,t,n)}}),E={path:null,regex:null,_query:{},_params:{},param(e){return void 0===e?this._params:void 0!==this._params[e]?this._params[e]:void 0},query(e){return void 0===e?this._query:void 0!==this._query[e]?this._query[e]:void 0},location(){var e=this._params,t=this.path;for(const n in e)e.hasOwnProperty(n)&&(t=t.replace(":"+n,e[n]));return t}},O=[],R=E,$={mode:window.history.pushState?"history":"hash",base:"",prevent:!1};function A(e,t){return e=("/"+(e=(e=(e=(e=e.replace(window.location.origin,"")).replace($.base,"")).replace(new RegExp("[/]*$"),"")).replace(new RegExp("^[/]*"),""))).replace("//","/").replace("/?","?"),t&&(e=e.split("?")[0]),e}async function C(e,t){try{e=A(e);var r={previous:R,next:j(e),location:e,replace:t};await l(r,[].concat(n("routeBeforeChange"),[function(){this.replace&&($.prevent=!0,"history"===$.mode?history.pushState({},null,this.location):window.location.hash=this.location,$.prevent=!1);var e=this.next;if(!e)return R=null;var t=function(e){var t={},n=-1!==e.indexOf("?")?e.split("?")[1]:e;return""==(n=String(n).trim().replace(/^(\?|#|&)/,""))?t:(n.split("&").forEach(function(e){const n=e.replace(/\+/g," ").split("="),r=decodeURIComponent(n.shift()),o=n.length>0?decodeURIComponent(n.join("=")):null;void 0===t[r]&&(t[r]=o)}),t)}(this.location),n=function(e,t){var n={},r=A(t.path,!0).split("/").filter(Boolean);return A(e,!0).split("/").filter(Boolean).forEach(function(e,t){if(void 0!==r[t]&&":".charCodeAt(0)===r[t].charCodeAt(0)){const o=r[t].substr(1);n[o]=decodeURIComponent(e)}}),n}(this.location,e);e._query=t,e._params=n,R=e}],n("routeAfterChange")))}catch(e){console.warn("[V] Route error:",e)}}function j(e){var t=A(e,!0),n=null;for(let e=0;e<O.length;e++){const r=O[e];if(t.match(r.regex)){n=r;break}}return n}function S(e){C(e,!0)}function D(e){window.history.go(e)}function M(){$.prevent||C("hash"===$.mode?window.location.hash.replace("#",""):window.location.href)}function x(e){var t=e.target.closest("a"),n=window.location,r=function(e){return e.href.replace(/#.*/,"")};e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||t.protocol&&n.protocol!==t.protocol||t.hostname&&n.hostname!==t.hostname||"hash"!==$.mode&&t.href&&t.href.indexOf("#")>-1&&r(t)==r(n)||t.target&&""!==t.target||e.defaultPrevented||(S(t.href),e.preventDefault())}var I=Object.freeze({__proto__:null,options:$,beforeChange:function(e){n("routeBeforeChange",e)},afterChange:function(e){n("routeAfterChange",e)},add:function e(t){if(Array.isArray(t))return t.forEach(function(t){e(t)});var n=Object.assign({},E,t);n.path=A(n.path,!0);var r=n.path,o=["([^/]+)"];["(:[a-zA-Z]+)"].forEach(function(e,t){r=r.replace(new RegExp(e,"g"),o[t])}),n.regex=new RegExp("^"+r+"$","i"),O.push(n)},change:C,match:j,active:function(){return R},redirect:S,go:D,forward:function(e){D(null==e?1:e)},back:function(e){D(null==e?-1:e)},attachEvents:function(){s(window,"popstate",M),s(document,"click","a",x)}});var B=Object.freeze({__proto__:null,set:function(e,t){t instanceof Object&&(t=JSON.stringify(t)),localStorage.setItem(e,t)},get:function(e,t){var n=localStorage.getItem(e);return 1==t&&n&&(n=JSON.parse(n)),n}});var P=Object.freeze({__proto__:null,set:function(e,t){t instanceof Object&&(t=JSON.stringify(t)),sessionStorage.setItem(e,t)},get:function(e,t){var n=sessionStorage.getItem(e);return 1==t&&n&&(n=JSON.parse(n)),n}});return e.$=o,e.$$=a,e.$$$=c,e.__version="1.0.0",e.afterDestroy=function(e){n("componentAfterDestroy",e)},e.afterMount=g,e.afterRender=function(e){n("componentAfterRender",e)},e.beforeDestroy=function(e){n("componentBeforeDestroy",e)},e.beforeMount=function(e){n("componentBeforeMount",e)},e.beforeRender=function(e){n("componentBeforeRender",e)},e.component=async function(e,t){var n=Object.assign({},v,t);n.selector=e,n.namespace||(n.namespace=e.replace(/[\W_]+/g,"_"));try{var r=[].concat([n.constructor]);await l(n,r),d.push(n)}catch(e){console.warn("[V] Component construct error:",e)}return n},e.destroy=async function(e){var t=[];return y(e,function(e,r){var o=r.namespace;if(void 0!==e._components[o]){var a=e._components[o];delete e._components[o];var c=[].concat(n("componentBeforeDestroy"),[a.beforeDestroy],[a.onDestroy],[a.afterDestroy],n("componentAfterDestroy"));t.push(l(a,c))}}),await Promise.all(t),e},e.each=function(e,t){if(Array.isArray(e))return e.forEach(t);const n=Object.keys(e);for(const r of n)t(e[r],r,e)},e.eachComponent=y,e.extendComponent=m,e.fakePromise=f,e.hook=n,e.http=b,e.local=B,e.mount=_,e.off=u,e.on=s,e.promises=l,e.promisify=p,e.removeComponent=async function(e){var t=null,n=null;if(d.forEach(function(r,o){r.selector==e&&(t=r,n=o)}),t)try{var r=[].concat([t.destructor]);await l(t,r),delete d[n]}catch(e){console.warn("[V] Component destruct error:",e)}},e.route=I,e.session=P,e.template=h,e.trigger=function(e,t){var n=c(e),r=document.createEvent("HTMLEvents");r.initEvent(t,!0,!0),n.forEach(function(e){e.dispatchEvent(r)})},Object.defineProperty(e,"__esModule",{value:!0}),e}({});