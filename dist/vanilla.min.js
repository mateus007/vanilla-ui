var V=function(e){"use strict";var t=[];function n(e,n){if(void 0===n)return t[e]?t[e]:[];t[e]=t[e]||[],t[e].push(n)}function r(e,t){if(Array.isArray(e))return e.forEach(t);const n=Object.keys(e);for(const r of n)t(e[r],r,e)}function o(e){return e=(e="string"==typeof e?a(e):e)instanceof Node?e:document}function a(e,t){return o(t).querySelector(e)}function c(e,t){return o(t).querySelectorAll(e)}function i(e,t){var n=[];return"string"==typeof e&&(e=c(e,t)),e instanceof Window&&n.push(e),e instanceof HTMLDocument&&n.push(e),e instanceof Element&&n.push(e),e instanceof NodeList&&Array.prototype.forEach.call(e,function(e){n.push(e)}),n}function s(e,t,n,r,o){var a,c=i(t),s=n.split(" ");return void 0===o?(a=r,r=null):a=function(e){var t=e.target.closest(r);t&&o.apply(t,[e])},c.forEach(function(t){for(var n=0;n<s.length;n++)"add"==e?t.addEventListener(s[n],a.bind(t),!1):t.removeEventListener(s[n],a.bind(t),!1)}),a}function u(e,t,n,r){return s("add",e,t,n,r)}function f(e,t,n,r){return s("remove",e,t,n,r)}function l(e,t){var n=i(e),r=document.createEvent("HTMLEvents");r.initEvent(t,!0,!0),n.forEach(function(e){e.dispatchEvent(r)})}async function p(){}async function h(e,t){try{return await t.apply(e)}catch(e){return Promise.reject(e)}}async function d(e,t){var n=[];for(let r=0;r<t.length;r++)"function"==typeof t[r]&&n.push(h(e,t[r]));return await Promise.all(n),e}var v={};function m(e){return e.replace(/\s+/g," ").replace(/^{{\s?/,"").replace(/\s?}}$/,"")}function y(e){return e.replace(/^if\s?(.*)$/,"if( $1 ){").replace(/^else$/,"} else {").replace(/^end$/,"}")}function g(e){return e.replace(/^for\s?(.*)\sin\s(.*)$/,"for( var $1 in $2 ){").replace(/^each\s?(.*)\s?=>\s?(.*)\sin\s(.*)$/,"for( var $1 in $3 ){ var $2 = $3[$1];").replace(/^each\s?(.*)\sin\s(.*)$/,"for( var _$1 in $2 ){ var $1 = $2[_$1];")}function _(e){var t=[],n=function(n){var r=e.match(n);r&&t.push(r[1])};return n(/^(?!}|for\(|if\()([A-Za-z0-9_]+)/),n(/^if\(\s?!?([A-Za-z0-9_]+)/),n(/&&\s?!?([A-Za-z0-9_]+)/),n(/\|\|\s?!?([A-Za-z0-9_]+)/),n(/in\s([A-Za-z0-9_]+)\s\)/),t}function w(e,t){var n,o=/{{([^}}]+)?}}/g,a=[],c=0,i="",s="",u="";for(r(t=Object.assign({},v,t||{}),function(e,t){a.push("var "+t+' = this["'+t+'"];')}),a.push("var r = [];");n=o.exec(e);)i=g(i=y(i=m(n[0]))),s=e.slice(c,n.index),c=n.index+n[0].length,a.push("r.push(`"+s.replace(/"/g,'\\"')+"`);"),_(i).filter(function(e){void 0===t[e]&&a.push("var "+e+";")}),a.push(i.match(/^(}|{|for\(|if\()/)?i:"r.push("+i+");");u=e.substr(c,e.length-c),a.push("r.push(`"+u.replace(/"/g,'\\"')+"`);"),a.push('return r.join("");');var f=a.join("\n");try{var l=new Function(f.replace(/[\r\t\n]/g,"")).apply(t||{})}catch(t){console.warn("[V] template parser error:",e,t)}return l}var b=[],E={element:null,selector:null,namespace:null,constructor:p,destructor:p};function $(e){Object.assign(E,e)}function A(e,t){b.forEach(function(n){i(n.selector,e).forEach(function(e){void 0===e._components&&(e._components={}),void 0===e._state&&(e._state={}),void 0===e._events&&(e._events={}),t.apply(e,[e,n])})})}function O(e){n("componentAfterMount",e)}async function R(e){var t=[];return A(e,function(e,r){var o=r.namespace;if(void 0===e._components[o]){e.dataset.vid||(e.dataset.vid=Math.random().toString(16).substr(2,8));var a=Object.assign({},r);a.element=e,e._components[o]=a;var c=[].concat(n("componentBeforeMount"),[a.beforeMount],[a.onMount],[a.afterMount],n("componentAfterMount"));t.push(d(a,c))}}),await Promise.all(t),e}async function j(e,t,r,o){var a={method:e,url:t,data:r,headers:o};await d(a,n("httpInterceptBefore"));var c=Object.assign({},a);if(delete c.url,delete c.data,"GET"!=c.method)void 0!==c.body&&null!==c.body||(c.body=a.data,c.body instanceof FormData==0&&(c.body=JSON.stringify(c.body),c.headers["Content-Type"]="application/json; charset=utf8"));else{var i="";"string"==typeof a.data?i=a.data:a.data&&(i=Object.keys(a.data).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(a.data[e])}).join("&")),i&&(a.url+="?"+i)}var s=await fetch(a.url,c),u=await s.text();try{u=JSON.parse(u)}catch(e){}var f={request:a,response:s,body:u};if(await d(f,n("httpInterceptAfter")),!s.ok)throw f;return u}$({beforeDestroy:p,onDestroy:p,afterDestroy:p}),$({on:function(e,t,n){var r=this.element;void 0===n?(n=t,t=this.selector):t=this.selector+" "+t;var o=e+"-"+t,a=r.dataset.vid;a='[data-vid="'+a+'"]';r._events[o]=u(document,e,t,function(e){e.target.closest(a)&&n.apply(e.target.closest(t),[e])})},off:function(e,t){var n=this.element,r=e+"-"+(t=t?this.selector+" "+t:this.selector),o=n._events[r];o&&(delete n._events[r],f(document,e,t,o))},trigger:function(e,t){l(t=t?this.selector+" "+t:this.selector,e)}}),$({beforeMount:p,onMount:p,afterMount:p}),$({template:p,renderTemplate:async function(){var e=await this.template();if(void 0!==e&&!1!==e){var t=this.get(),n=w(String(e),t);this.element.innerHTML=n}},shouldRender:async function(){return!0},beforeRender:p,onRender:p,afterRender:p,render:async function(e){void 0!==e&&this.set(e);if(await this.shouldRender())try{var t=[].concat(n("componentBeforeRender"),[this.beforeRender],[this.renderTemplate],[this.onRender],[this.afterRender],n("componentAfterRender"));await d(this,t),await R(this.element)}catch(e){console.warn("[V] Component render error:",e)}}}),O(async function(){return this.render()}),$({set:function(e,t){var n=this.element;"string"==typeof e?n._state[e]=t:n._state=Object.assign(n._state,e)},get:function(e,t){var n=this.element;if(void 0===e)return n._state;var r=n._state[e];return r=void 0===r?t:r}});var C=Object.freeze({__proto__:null,interceptBefore:function(e){n("httpInterceptBefore",e)},interceptAfter:function(e){n("httpInterceptAfter",e)},request:j,options:function(e,t,n){return j("OPTIONS",e,t,n)},head:function(e,t,n){return j("HEAD",e,t,n)},get:function(e,t,n){return j("GET",e,t,n)},post:function(e,t,n){return j("POST",e,t,n)},put:function(e,t,n){return j("PUT",e,t,n)},patch:function(e,t,n){return j("PATCH",e,t,n)},_delete:function(e,t,n){return j("DELETE",e,t,n)}}),S={path:null,regex:null,_query:{},_params:{},param(e){return void 0===e?this._params:void 0!==this._params[e]?this._params[e]:void 0},query(e){return void 0===e?this._query:void 0!==this._query[e]?this._query[e]:void 0},location(){var e=this._params,t=this.path;for(const n in e)e.hasOwnProperty(n)&&(t=t.replace(":"+n,e[n]));return t}},D=[],M=S,x={mode:window.history.pushState?"history":"hash",base:"",prevent:!1};function B(e,t){return e=("/"+(e=(e=(e=(e=e.replace(window.location.origin,"")).replace(x.base,"")).replace(new RegExp("[/]*$"),"")).replace(new RegExp("^[/]*"),""))).replace("//","/").replace("/?","?"),t&&(e=e.split("?")[0]),e}async function I(e,t){try{e=B(e);var r={previous:M,next:T(e),location:e,replace:t};await d(r,[].concat(n("routeBeforeChange"),[function(){this.replace&&(x.prevent=!0,"history"===x.mode?history.pushState({},null,this.location):window.location.hash=this.location,x.prevent=!1);var e=this.next;if(!e)return M=null;var t=function(e){var t={},n=-1!==e.indexOf("?")?e.split("?")[1]:"";return""==(n=String(n).trim().replace(/^(\?|#|&)/,""))?t:(n.split("&").forEach(function(e){const n=e.replace(/\+/g," ").split("="),r=decodeURIComponent(n.shift()),o=n.length>0?decodeURIComponent(n.join("=")):null;void 0===t[r]&&(t[r]=o)}),t)}(this.location),n=function(e,t){var n={},r=B(t.path,!0).split("/").filter(Boolean);return B(e,!0).split("/").filter(Boolean).forEach(function(e,t){if(void 0!==r[t]&&":".charCodeAt(0)===r[t].charCodeAt(0)){const o=r[t].substr(1);n[o]=decodeURIComponent(e)}}),n}(this.location,e);e._query=t,e._params=n,M=e}],n("routeAfterChange")))}catch(e){console.warn("[V] Route error:",e)}}function T(e){var t=B(e,!0),n=null;for(let e=0;e<D.length;e++){const r=D[e];if(t.match(r.regex)){n=r;break}}return n}function P(e){return I(e,!0)}function q(e){window.history.go(e)}function z(){x.prevent||I("hash"===x.mode?window.location.hash.replace("#",""):window.location.href)}function k(e){var t=e.target.closest("a"),n=window.location,r=function(e){return e.href.replace(/#.*/,"")};e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||t.protocol&&n.protocol!==t.protocol||t.hostname&&n.hostname!==t.hostname||"hash"!==x.mode&&t.href&&t.href.indexOf("#")>-1&&r(t)==r(n)||t.target&&""!==t.target||e.defaultPrevented||(P(t.href),e.preventDefault())}var L=Object.freeze({__proto__:null,options:x,beforeChange:function(e){n("routeBeforeChange",e)},afterChange:function(e){n("routeAfterChange",e)},add:function e(t){if(Array.isArray(t))return t.forEach(function(t){e(t)});var n=Object.assign({},S,t);n.path=B(n.path,!0);var r=n.path,o=["([^/]+)"];["(:[a-zA-Z]+)"].forEach(function(e,t){r=r.replace(new RegExp(e,"g"),o[t])}),n.regex=new RegExp("^"+r+"$","i"),D.push(n)},change:I,match:T,active:function(){return M},redirect:P,go:q,forward:function(e){q(null==e?1:e)},back:function(e){q(null==e?-1:e)},attachEvents:function(){u(window,"popstate",z),u(document,"click","a",k)}});function N(e,t,n){n instanceof Object&&(n=JSON.stringify(n)),e.setItem(t,n)}function U(e,t){var n=e.getItem(t);try{n=JSON.parse(n)}catch(e){}return n}function V(e,t){e.removeItem(t)}var Z=Object.freeze({__proto__:null,set:function(e,t){return N(localStorage,e,t)},get:function(e){return U(localStorage,e)},remove:function(e){return V(localStorage,e)}});var H=Object.freeze({__proto__:null,set:function(e,t){return N(sessionStorage,e,t)},get:function(e){return U(sessionStorage,e)},remove:function(e){return V(sessionStorage,e)}});return e.$=a,e.$$=c,e.$$$=i,e.__version="1.0.4",e.afterDestroy=function(e){n("componentAfterDestroy",e)},e.afterMount=O,e.afterRender=function(e){n("componentAfterRender",e)},e.beforeDestroy=function(e){n("componentBeforeDestroy",e)},e.beforeMount=function(e){n("componentBeforeMount",e)},e.beforeRender=function(e){n("componentBeforeRender",e)},e.component=async function(e,t){var n=Object.assign({},E,t);n.selector=e,n.namespace||(n.namespace=e.replace(/[\W_]+/g,"_"));try{var r=[].concat([n.constructor]);await d(n,r),b.push(n)}catch(e){console.warn("[V] Component construct error:",e)}return n},e.destroy=async function(e){var t=[];return A(e,function(e,r){var o=r.namespace;if(void 0!==e._components[o]){var a=e._components[o];delete e._components[o];var c=[].concat(n("componentBeforeDestroy"),[a.beforeDestroy],[a.onDestroy],[a.afterDestroy],n("componentAfterDestroy"));t.push(d(a,c))}}),await Promise.all(t),e},e.each=r,e.eachComponent=A,e.extendComponent=$,e.fakePromise=p,e.helper=function(e,t){v[e]=t},e.hook=n,e.http=C,e.local=Z,e.mount=R,e.off=f,e.on=u,e.promises=d,e.promisify=h,e.removeComponent=async function(e){var t=null,n=null;if(b.forEach(function(r,o){r.selector==e&&(t=r,n=o)}),t)try{var r=[].concat([t.destructor]);await d(t,r),delete b[n]}catch(e){console.warn("[V] Component destruct error:",e)}},e.route=L,e.session=H,e.template=w,e.trigger=l,Object.defineProperty(e,"__esModule",{value:!0}),e}({});